<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AMiRo-OS: Remote</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMiRo-OS
   &#160;<span id="projectnumber">2.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__core__shell__shellremote.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle">
<div class="title">Remote<div class="ingroups"><a class="el" href="group__core.html">Core</a> &raquo; <a class="el" href="group__core__shell.html">Shell</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Todo.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga163fdf92cca2cbd21c62a0d20fd06b3c"><td class="memItemLeft" align="right" valign="top"><a id="ga163fdf92cca2cbd21c62a0d20fd06b3c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core__shell__shellremote.html#ga163fdf92cca2cbd21c62a0d20fd06b3c">AOS_SHELL_EVENT_REMOTETIMER</a>&#160;&#160;&#160;EVENT_MASK(1)</td></tr>
<tr class="memdesc:ga163fdf92cca2cbd21c62a0d20fd06b3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event mask to be set on a remote timer event. <br /></td></tr>
<tr class="separator:ga163fdf92cca2cbd21c62a0d20fd06b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga26a174e0f31b63acc1c53b80bfef0f16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core__shell__shellremote.html#ga26a174e0f31b63acc1c53b80bfef0f16">AOS_SHELL_REMOTEIDWIDTH</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:ga26a174e0f31b63acc1c53b80bfef0f16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes for a remote shell identifier type.  <a href="#ga26a174e0f31b63acc1c53b80bfef0f16">More...</a><br /></td></tr>
<tr class="separator:ga26a174e0f31b63acc1c53b80bfef0f16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga04e3f3c788c5ac4ecceddce22b35f23a"><td class="memItemLeft" align="right" valign="top"><a id="ga04e3f3c788c5ac4ecceddce22b35f23a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core__shell__shellremote.html#ga04e3f3c788c5ac4ecceddce22b35f23a">AOS_SHELL_RMSG_MAXLENGTH</a>&#160;&#160;&#160;(<a class="el" href="group__core__shell__shellremote.html#ga26a174e0f31b63acc1c53b80bfef0f16">AOS_SHELL_REMOTEIDWIDTH</a> + 2)</td></tr>
<tr class="memdesc:ga04e3f3c788c5ac4ecceddce22b35f23a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lenth of the longest expected remote access control message. <br /></td></tr>
<tr class="separator:ga04e3f3c788c5ac4ecceddce22b35f23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga6204578792eed6b8c13211a31c51dc20"><td class="memItemLeft" align="right" valign="top">typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core__shell__shellremote.html#ga6204578792eed6b8c13211a31c51dc20">aos_shellremoteid_t</a></td></tr>
<tr class="memdesc:ga6204578792eed6b8c13211a31c51dc20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remote identifier type.  <a href="#ga6204578792eed6b8c13211a31c51dc20">More...</a><br /></td></tr>
<tr class="separator:ga6204578792eed6b8c13211a31c51dc20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Todo. </p>
<p>Todo </p>


<h3><a id="shellremoteprotocol"></a>Remote Access Control Protocol</h3><div class="textblock">The remote access control protocol is a very light-weight protocol for simple, cooperative remote shell access and comprises commands:</p><ul>
<li>discover request: ['ENQ' '?']<br />
 The emitting shell requests all shells connected to a channel to name their individual identifiers.</li>
<li>discover response: ['ENQ' '!' identifier]<br />
 Answering a discover request, a shell broadcasts its identifier via the channel on which the request was received.</li>
<li>client request: ['ENQ' '#']<br />
 The emitting shell requests the client on the channel to name its individual identifier.</li>
<li>client response: ['ENQ' '~' identifier]<br />
 Answering a client request, the shell broadcasts its identifier via the channel on which the request was received.</li>
<li>connect: ['ENQ' '@' identifier]<br />
 A shell requests a connection to another remote shell. As soon as that server acknowledges, the requesting shell becomes either the client (if it was neither server nor client before) or disconnected. The requesting shell furthermore has to cancel the request on all other channels (see below). If the target shell does not reply in time, the requesting shell must send a cancelation message (see below). Any shell can request a remote connection to any other shell at any time.</li>
<li>acknowledge: ['ENQ' '+']<br />
 A shell that has been requested as server for a remote connection acknowledges this request. It immediately becomes the server and the requesting shell becomes the client.</li>
<li>cancel: ['ENQ' '-']<br />
 All shells currently active on the channel (server or client) must close this connection immediately. Cancellation messages are transmitted whenever some error occurred or a connection is disconnected by the user.</li>
<li>disable: ['ENQ' '\']<br />
 The channel on which this message was received must be closed and disabled for further remote communication. Disable messages are transmitted if a shell detects a duplicate identifier.</li>
</ul>
The protocol as described above allows to discover all shells on a channel, e.g. in order to list all available shells for the user. Channels in this case are assumed to be independant communication interfaces to which a shell is connected to for serial user I/O (e.g. UART, SPI, CAN). There must be no more than a single remote connection per channel.<dl class="section user"><dt>Security</dt><dd>Note that this protocol is indeed very simple and not secured against malicious interventions in any form. As soon as a remote connection has been established, the actual data exchanged between shells can be encrypted, though (not implemented).</dd></dl>
<dl class="section user"><dt>Examples</dt><dd>Let A, B, and C be shells; let X and Y be channels.<ul>
<li>list remotes<br />
<ol type="1">
<li>A emits a discover request via X and Y and sets an internal timeout.</li>
<li>B responds quickly, so A lists its identifier to the user.</li>
<li>The timeout expires and A returns to normal operation.</li>
<li>C responds late, so its message has no effect.</li>
</ol>
</li>
<li>connection request timeout<br />
<ol type="1">
<li>A requests a remote connection to B and sets an internal timeout.</li>
<li>B does not respond in time, so A cancels the request by emmiting a cancelation message.</li>
<li>Due to internal delays, B has sent an acknowledgement (but too late) before it detects the cancellation message. While it had established the connection internaly for a brief moment, it has to undo this state as soon as the cancelation message has been processed.</li>
</ol>
</li>
<li>establishing a connection<br />
<ol type="1">
<li>A requests a remote connection to B and sets an internal timeout.</li>
<li>B acknowledges quickly, so both, A and B, update their internal values. A also resets the timeout. The connection has been established with A being the client and B the server.</li>
</ol>
</li>
<li>traversal along channels<br />
<ol type="1">
<li>The shells A and B are connected via channel X, B and C are connected via channel Y. The user is currently on A but wants to connect to C.</li>
<li>A first remote connection needs to be etsablished on channel X to the "proxy" shell B.</li>
<li>From B the user can traverse further via channel Y to shell C.</li>
</ol>
</li>
<li>interrupting an established or broken connection<br />
<ol type="1">
<li>A remote connection has already been established between B and C, but for some reason the connection stalled.</li>
<li>A new remote connection is requested from A to C.</li>
<li>C acknowledges the request and cancels the previous connection to B.</li>
<li>B takes note of the new connection as well and cancels the previos connection to C as well. </li>
</ol>
</li>
</ul>
</dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga26a174e0f31b63acc1c53b80bfef0f16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga26a174e0f31b63acc1c53b80bfef0f16">&#9670;&nbsp;</a></span>AOS_SHELL_REMOTEIDWIDTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AOS_SHELL_REMOTEIDWIDTH&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes for a remote shell identifier type. </p>
<p>Allowed values are 1, 2, 4 and 8. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga6204578792eed6b8c13211a31c51dc20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6204578792eed6b8c13211a31c51dc20">&#9670;&nbsp;</a></span>aos_shellremoteid_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t <a class="el" href="group__core__shell__shellremote.html#ga6204578792eed6b8c13211a31c51dc20">aos_shellremoteid_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remote identifier type. </p>
<p>A identifier value of 0 is considered invalid. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
